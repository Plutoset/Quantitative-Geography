### 第六章作业

##### 10193903446 汤博

1. 求:

$$
max Z = 7x_{1}+9x_{2}-8x_{3}+6x_{4}
\\
\\
s.t. \left\{\begin{array}{l}
3 x_{1}-x_{2}+x_{3}+5 x_{4} \leq 30 \\
x_{1}+2 x_{2}+x_{3}-x_{4} \leq 20 \\
6 x_{1}+2 x_{2}-x_{3}-2 x_{4} \leq 50 \\
x_{1}, x_{2}, x_{3}, x_{4} \geq 0
\end{array}\right.
$$

目标函数可以改写成：
$$
min f^{T}x = -7x_{1}-9x_{2}+8x_{3}-6x_{4}
$$
代码如下：

```matlab
clear;clc;
f = [-7 -9 8 -6];
A = [3 -1 1 5; 1 2 1 -1; 6 2 -1 -2];
b = [30; 20; 50];
lb = [0 0 0 0];
[ x,fval ]=linprog(f,A,b,[],[],lb,[]);
```

求解结果：
$$
x_{1}=0,x_{2}=14.44,x_{3}=0,x_{4}=8.89
$$


2. 工厂经营目标的期望值及优先级如下：
   1. 每周总利润不得低于10000元；
   2. 因合同要求，A型机器每周至少生产10台；B型机器每周至少生产15台；
   3. 由于条件限制且希望充分利用工厂生产能力，要充分利用工序I的时间，但尽量不加班；工序II的每周生产时间可适当超过其最大加工能力（允许加班）。

![image-20211119153537676](C:\Users\Wingnes\AppData\Roaming\Typora\typora-user-images\image-20211119153537676.png)

A，B型及其生产是刚性约束，其他是柔性约束。最重要的指标是企业的利润。建立相应的目标规划模型：


$$
P_{1} \text{: 每周总利润不得低于10000元}\\
P_{2} \text{: 充分利用工序I的时间}\\
P_{3} \text{: 工序II的允许加班}\\\\

min P_{1}d^{-}_{1}+ P_{2}(d^{-}_{2}+d^{+}_{2}) + P_{3}d^{-}_{3}
\\
\\
s.t. \left\{\begin{array}{l}
x_{1a}+x_{2a} - x_{4} = 10 \\
x_{1b}+x_{2b} - x_{5} = 15 \\
300 x_{1a}+450 x_{1b}+ 300 x_{2a}+ 450 x_{2b} +d^{-}_{1} -d^{+}_{1} = 10000 \\
4 x_{1a}+6 x_{1b} +d^{-}_{2} -d^{+}_{2} = 150 \\
3 x_{2a}+2 x_{2b} +d^{-}_{3} -d^{+}_{3} =  70 \\
x_{1a}, x_{1b}, x_{2a}, x_{2b},x_{4},x_{5},d^{+}_{i},d^{-}_{i} \geq 0, \quad i=1,2,3,4 \\
x_{1a}, x_{1b}, x_{2a}, x_{2b},x_{4},x_{5} \text{均为整数。}
\end{array}\right.
$$



第一步
$$
min d^{-}_{1}
\\
\\
\left\{\begin{array}{l}
x_{1a}+x_{2a} - x_{4} = 10 \\
x_{1b}+x_{2b} - x_{5} = 15 \\
300 x_{1a}+450 x_{1b}+ 300 x_{2a}+ 450 x_{2b} +d^{-}_{1} -d^{+}_{1} = 10000 \\
x_{1a}, x_{1b}, x_{2a}, x_{2b},x_{4},x_{5},d^{+}_{1},d^{-}_{1} \geq 0
\end{array}\right.
$$

```matlab
% 第一步
% x1a x1b x2a x2b x4 x5 d1- d1+ d2- d2+ d3- d3+
% min d1-
% x1a + x2a - x4 = 10
% x1b + x2b - x5 = 15
% 300x1a + 450x1b + 300x2a + 450x2b + d1- - d1+ = 10000
% x1a, x1b, x2a, x2b >= 0, d1- >= 0,d1+ >= 0
Aeq1 = [1 0 1 0 -1 0 0 0 0 0 0 0; 
        0 1 0 1 0 -1 0 0 0 0 0 0; 
        300 450 300 450 0 0 1 -1 0 0 0 0];
beq1 = [10; 15; 10000];
f = [0 0 0 0 0 0 1 0 0 0 0 0];
lb = [0 0 0 0 0 0 0 0 0 0 0 0];
intcon = 1:4;
[x1,fval] = intlinprog(f,intcon,[],[],Aeq1,beq1,lb)
```

结果为：
$$
x_{1a}=0, x_{1b}=0, x_{2a}=11, x_{2b}=15\\x_{4}=1,x_{5}=0\\d^{-}_{1}=d^{+}_{2}=d^{-}_{2}=d^{-}_{3}=d^{+}_{3}=0, d^{+}_{1}=50.\\
fval=0
$$
第二步
$$
min (d^{-}_{2}+d^{+}_{2})
\\
\\
\left\{\begin{array}{l}
x_{1a}+x_{2a} - x_{4} = 10 \\
x_{1b}+x_{2b} - x_{5} = 15 \\
300 x_{1a}+450 x_{1b}+ 300 x_{2a}+ 450 x_{2b} +d^{-}_{1} -d^{+}_{1} = 10000 \\
4 x_{1a}+6 x_{1b} +d^{-}_{2} -d^{+}_{2} = 150 \\
d^{-}_{1} = 0\\
x_{1a}, x_{1b}, x_{2a}, x_{2b},x_{4},x_{5},d^{+}_{i},d^{-}_{i} \geq 0, \quad i = 1,2
\end{array}\right.
$$

```matlab
% 第二步
% x1a x1b x2a x2b x4 x5 d1- d1+ d2- d2+ d3- d3+
% min d2-+d2+
% x1a + x2a - x4 = 10
% x1b + x2b - x5 = 15
% 300x1a + 450x1b + 300x2a + 450x2b + d1- - d1+ = 10000
% 4x1a + 6x1b + d2- - d2+ = 150
% d1- = 0
% x1,x2,x3>=0,d1->=0,d1+>=0,d2->=0,d2+>=0
Aeq2 = [1 0 1 0 -1 0 0 0 0 0 0 0; 
     0 1 0 1 0 -1 0 0 0 0 0 0; 
     300 450 300 450 0 0 1 -1 0 0 0 0;
     4 6 0 0 0 0 0 0 1 -1 0 0;
     0 0 0 0 0 0 1 0 0 0 0 0];
beq2 = [10; 15; 10000; 150; 0];
f = [0 0 0 0 0 0 0 0 1 1 0 0];
lb = [0 0 0 0 0 0 0 0 0 0 0 0];
intcon = 1:4;
[x2,fval] = intlinprog(f,intcon,[],[],Aeq2,beq2,lb)
```

结果为：
$$
x_{1a}=9, x_{1b}=19, x_{2a}=1, x_{2b}=0\\x_{4}=0,x_{5}=4\\d^{-}_{1}=d^{+}_{2}=d^{-}_{2}=d^{-}_{3}=d^{+}_{3}=0, d^{+}_{1}=1550.\\
fval=0
$$
第三步
$$
min d^{-}_{3}
\\
\\
\left\{\begin{array}{l}
x_{1a}+x_{2a} - x_{4} = 10 \\
x_{1b}+x_{2b} - x_{5} = 15 \\
300 x_{1a}+450 x_{1b}+ 300 x_{2a}+ 450 x_{2b} +d^{-}_{1} -d^{+}_{1} = 10000 \\
4 x_{1a}+6 x_{1b} +d^{-}_{2} -d^{+}_{2} = 150 \\
3 x_{2a}+2 x_{2b} +d^{-}_{3} -d^{+}_{3} =  70 \\
d^{-}_{1} = 0\\
d^{-}_{2}+ d^{+}_{2} = 0\\
x_{1a}, x_{1b}, x_{2a}, x_{2b},x_{4},x_{5},d^{+}_{i},d^{-}_{i} \geq 0, \quad i = 1,2,3
\end{array}\right.
$$

```matlab
%第三步
% x1a x1b x2a x2b x4 x5 d1- d1+ d2- d2+ d3- d3+
% min d2-+d2+
% x1a + x2a - x4 = 10
% x1b + x2b - x5 = 15
% 300x1a + 450x1b + 300x2a + 450x2b + d1- - d1+ = 10000
% 4x1a + 6x1b + d2- - d2+ = 150
% 3x2a + 2x2b + d3- - d3+ = 70
% d1- = 0
% d2- + d2+ = 0
% x1,x2,x3>=0; d1->=0,d1+>=0,d2->=0,d2+>=0,d3->=0,d3+>=0

Aeq3 = [1 0 1 0 -1 0 0 0 0 0 0 0; 
     0 1 0 1 0 -1 0 0 0 0 0 0; 
     300 450 300 450 0 0 1 -1 0 0 0 0;
     4 6 0 0 0 0 0 0 1 -1 0 0;
     0 0 0 3 2 0 0 0 0 0 1 -1;
     0 0 0 0 0 0 1 0 0 0 0 0;
     0 0 0 0 0 0 0 0 1 1 0 0];
beq3 = [10; 15; 10000; 150; 70; 0; 0];
f = [0 0 0 0 0 0 0 0 0 0 1 0];
lb = [0 0 0 0 0 0 0 0 0 0 0 0];
intcon = 1:4;
[x3,fval3]=intlinprog(f,intcon,[],[],Aeq3,beq3,lb)
```

最终解出的结果为：
$$
x_{1a}=0, x_{1b}=25, x_{2a}=24, x_{2b}=0\\x_{4}=14,x_{5}=10\\d^{-}_{1}=d^{+}_{2}=d^{-}_{2}=d^{+}_{3}=0, d^{+}_{1}=8450, d^{-}_{3}=2.
$$
工序I生产25台B型机器，工序II生产24台A型机器，最终生产了25台A型机器和24台B型机器，超过原计划的生产A计划14台，超过原计划的生产B计划10台，总利润为18450元，其中充分利用工序I的时间150小时，利用工序II的时间72小时，超出其最大加工能力（70小时）的范围为2小时。

